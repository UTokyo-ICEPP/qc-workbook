Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/usr/local/lib/python3.8/dist-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/usr/local/lib/python3.8/dist-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/usr/local/lib/python3.8/dist-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/usr/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/usr/local/lib/python3.8/dist-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/usr/local/lib/python3.8/dist-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/usr/local/lib/python3.8/dist-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# ã‚ªãƒªã‚¸ãƒŠãƒ«ã®å›è·¯ã‚’ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã€‚optimization_level=3ã¯è‡ªå‹•è¨­å®šã®ã†ã¡ã€æœ€ã‚‚åŠ¹ç‡ã®ã„ã„å›è·¯ã‚’ä½œã‚‹
# ãƒ•ã‚§ã‚¤ã‚¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®å ´åˆã€å°‘ã—æ™‚é–“ãŒã‹ã‹ã‚‹ã®ã§æ°—é•·ã«å¾…ã£ã¦ãã ã•ã„
print('Transpiling the original circuit with standard settings')
circuit_original_tr = transpile(circuit_original, backend=backend, optimization_level=3)

# åŠ¹ç‡åŒ–ã—ãŸå›è·¯ã‚’ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã€‚ãƒã‚·ãƒ³ã®ãƒˆãƒãƒ­ã‚¸ãƒ¼ã«å¾“ã„ã€æœ€ã‚‚åˆè¨ˆã‚¨ãƒ©ãƒ¼ç‡ã®ä½ã„é‡å­ãƒ“ãƒƒãƒˆåˆ—ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹
print('Transpiling the optimized circuit with trivial mapping onto a chain of qubits')
initial_layout = find_best_chain(backend, n1 + n2 + n3)
circuit_optimized_tr = transpile(circuit_optimized, backend=backend,
                                 routing_method='basic', initial_layout=initial_layout,
                                 optimization_level=3)

# count_opsã¯å›è·¯ã«å«ã¾ã‚Œã‚‹åŸºæœ¬ã‚²ãƒ¼ãƒˆã®æ•°ã‚’è¾æ›¸ã¨ã—ã¦è¿”ã™
nops_orig = circuit_original_tr.count_ops()
nops_opt = circuit_optimized_tr.count_ops()

print(f'Number of operations in the original circuit: {circuit_original_tr.size()}')
print(f'  Breakdown: N(Rz)={nops_orig["rz"]}, N(X)={nops_orig["x"]}, N(SX)={nops_orig["sx"]}, N(CNOT)={nops_orig["cx"]}')
print(f'Number of operations in the optimized circuit: {circuit_optimized_tr.size()}')
print(f'  Breakdown: N(Rz)={nops_opt["rz"]}, N(X)={nops_opt["x"]}, N(SX)={nops_opt["sx"]}, N(CNOT)={nops_opt["cx"]}')
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mKeyError[0m                                  Traceback (most recent call last)
Input [0;32mIn [9][0m, in [0;36m<cell line: 20>[0;34m()[0m
[1;32m     18[0m [38;5;28mprint[39m([38;5;124mf[39m[38;5;124m'[39m[38;5;124m  Breakdown: N(Rz)=[39m[38;5;132;01m{[39;00mnops_orig[[38;5;124m"[39m[38;5;124mrz[39m[38;5;124m"[39m][38;5;132;01m}[39;00m[38;5;124m, N(X)=[39m[38;5;132;01m{[39;00mnops_orig[[38;5;124m"[39m[38;5;124mx[39m[38;5;124m"[39m][38;5;132;01m}[39;00m[38;5;124m, N(SX)=[39m[38;5;132;01m{[39;00mnops_orig[[38;5;124m"[39m[38;5;124msx[39m[38;5;124m"[39m][38;5;132;01m}[39;00m[38;5;124m, N(CNOT)=[39m[38;5;132;01m{[39;00mnops_orig[[38;5;124m"[39m[38;5;124mcx[39m[38;5;124m"[39m][38;5;132;01m}[39;00m[38;5;124m'[39m)
[1;32m     19[0m [38;5;28mprint[39m([38;5;124mf[39m[38;5;124m'[39m[38;5;124mNumber of operations in the optimized circuit: [39m[38;5;132;01m{[39;00mcircuit_optimized_tr[38;5;241m.[39msize()[38;5;132;01m}[39;00m[38;5;124m'[39m)
[0;32m---> 20[0m [38;5;28mprint[39m([38;5;124mf[39m[38;5;124m'[39m[38;5;124m  Breakdown: N(Rz)=[39m[38;5;132;01m{[39;00mnops_opt[[38;5;124m"[39m[38;5;124mrz[39m[38;5;124m"[39m][38;5;132;01m}[39;00m[38;5;124m, N(X)=[39m[38;5;132;01m{[39;00mnops_opt[[38;5;124m"[39m[38;5;124mx[39m[38;5;124m"[39m][38;5;132;01m}[39;00m[38;5;124m, N(SX)=[39m[38;5;132;01m{[39;00mnops_opt[[38;5;124m"[39m[38;5;124msx[39m[38;5;124m"[39m][38;5;132;01m}[39;00m[38;5;124m, N(CNOT)=[39m[38;5;132;01m{[39;00mnops_opt[[38;5;124m"[39m[38;5;124mcx[39m[38;5;124m"[39m][38;5;132;01m}[39;00m[38;5;124m'[39m)

[0;31mKeyError[0m: 'x'
KeyError: 'x'

